<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mundo Curioso - Plataforma Terap√©utica Interactiva</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600&display=swap" rel="stylesheet">
    <style>
        /* Reset y base */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Fredoka', sans-serif;
            background-color: #FFFBF2;
            color: #43382B;
            overflow-x: hidden;
            cursor: none; /* Ocultar cursor por defecto para usar el personalizado */
            min-height: 100vh;
        }

        /* Variables CSS para colores */
        :root {
            --fondo-pagina: #FFFBF2;
            --fondo-superficie: #FFFFFF;
            --texto-principal: #43382B;
            --texto-secundario: #8D7A61;
            --exito: #34D399;
            --alerta: #FBBF24;
            
            /* Colores por actividad */
            --aventura1-lavanda: #A78BFA;
            --aventura1-turquesa: #5EEAD4;
            --aventura1-violeta: #8B5CF6;
            --aventura1-cyan: #14B8A6;
            
            --burbujas-azul-cielo: #60A5FA;
            --burbujas-rosa: #F472B6;
            --burbujas-naranja: #FB923C;
            --burbujas-azul-prim: #3B82F6;
            
            --clasif-rojo: #EF4444;
            --clasif-amarillo: #FACC15;
            --clasif-azul: #2563EB;
            --clasif-verde: #10B981;
            
            --melodia-dorado: #F59E0B;
            --melodia-rosa: #FB7185;
            --melodia-ocre: #D97706;
            --melodia-rosa-pastel: #F9A8D4;
        }

        /* Cursor personalizado */
        .cursor-personalizado {
            position: fixed;
            width: 48px;
            height: 48px;
            border-radius: 50%;
            pointer-events: none;
            z-index: 9999;
            transition: all 0.1s ease-out;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
            background: var(--aventura1-violeta);
        }

        .cursor-click {
            animation: clickAnim 200ms ease-out;
        }

        @keyframes clickAnim {
            0% { transform: scale(1); }
            50% { transform: scale(0.8); }
            100% { transform: scale(1); }
        }

        /* Botones principales */
        .btn-principal {
            min-height: 120px;
            min-width: 240px;
            padding: 32px;
            background: var(--texto-principal);
            color: white;
            border: none;
            border-radius: 32px;
            font-family: 'Fredoka', sans-serif;
            font-size: 20px;
            font-weight: 600;
            cursor: pointer;
            transition: all 250ms cubic-bezier(0.34, 1.56, 0.64, 1);
            box-shadow: 0 8px 16px 0 rgba(141, 122, 97, 0.15), 0 4px 8px 0 rgba(141, 122, 97, 0.10);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 16px;
        }

        .btn-principal:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 24px 0 rgba(141, 122, 97, 0.20), 0 8px 16px 0 rgba(141, 122, 97, 0.15);
        }

        .btn-principal:active {
            transform: translateY(2px);
            box-shadow: inset 0 4px 8px 0 rgba(141, 122, 97, 0.2);
        }

        /* Tarjetas de selecci√≥n */
        .tarjeta-seleccion {
            width: 250px;
            height: 300px;
            padding: 32px;
            background: var(--fondo-superficie);
            border-radius: 32px;
            box-shadow: 0 8px 16px 0 rgba(141, 122, 97, 0.15), 0 4px 8px 0 rgba(141, 122, 97, 0.10);
            cursor: pointer;
            transition: all 300ms ease-in-out;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
        }

        .tarjeta-seleccion:hover {
            transform: translateY(-8px) scale(1.03);
            box-shadow: 0 16px 32px 0 rgba(141, 122, 97, 0.20), 0 8px 16px 0 rgba(141, 122, 97, 0.15);
        }

        .tarjeta-seleccion.seleccionada {
            border: 8px solid var(--exito);
        }

        /* Layout principal */
        .contenedor {
            max-width: 1024px;
            margin: 0 auto;
            padding: 24px;
        }

        .pantalla {
            display: none;
            min-height: 100vh;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            gap: 48px;
        }

        .pantalla.activa {
            display: flex;
        }

        .titulo {
            font-size: 48px;
            font-weight: 600;
            line-height: 1.2;
            color: var(--texto-principal);
        }

        .subtitulo {
            font-size: 32px;
            font-weight: 600;
            line-height: 1.3;
            color: var(--texto-principal);
        }

        .instrucciones {
            font-size: 24px;
            font-weight: 600;
            line-height: 1.4;
            color: var(--texto-secundario);
            max-width: 600px;
        }

        /* Navegaci√≥n fija */
        .nav-fija {
            position: fixed;
            top: 24px;
            left: 24px;
            right: 24px;
            display: flex;
            justify-content: space-between;
            z-index: 100;
        }

        .btn-nav {
            width: 80px;
            height: 80px;
            background: transparent;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 48px;
            transition: all 250ms ease;
        }

        .btn-nav:hover {
            transform: scale(1.1);
        }

        /* Efecto especial para el bot√≥n estrella */
        .btn-nav[title*="inicio"]:hover {
            transform: scale(1.2) rotate(15deg);
            animation: brillarEstrella 1s ease-in-out infinite;
        }

        @keyframes brillarEstrella {
            0%, 100% { 
                filter: drop-shadow(0 0 0px #F59E0B);
            }
            50% { 
                filter: drop-shadow(0 0 15px #F59E0B);
            }
        }

        /* Avatares por edad */
        .avatar {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 60px;
            margin-bottom: 16px;
            transition: transform 300ms ease;
        }

        .avatar.edad-3-4 {
            background: var(--clasif-amarillo);
        }

        .avatar.edad-5-6 {
            background: var(--burbujas-rosa);
        }

        .avatar.edad-7-8 {
            background: var(--melodia-dorado);
        }

        .avatar.edad-9-10 {
            background: var(--aventura1-cyan);
        }

        /* Lista de opciones */
        .lista-opciones {
            display: flex;
            gap: 32px;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center;
        }

        /* Barra de progreso */
        .barra-progreso {
            width: 400px;
            height: 24px;
            background: var(--fondo-pagina);
            border: 2px solid var(--texto-secundario);
            border-radius: 12px;
            overflow: hidden;
            margin: 24px 0;
        }

        .progreso-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--aventura1-lavanda), var(--aventura1-turquesa));
            border-radius: 12px;
            transition: width 500ms ease-out;
            width: 0%;
        }

        /* Animaciones de celebraci√≥n */
        .celebracion {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 80px;
            pointer-events: none;
            z-index: 1000;
            animation: celebracion 2000ms ease-out forwards;
        }

        @keyframes celebracion {
            0% {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.5);
            }
            20% {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1.2);
            }
            80% {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1);
            }
            100% {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.8);
            }
        }

        /* Animales */
        .animal {
            width: 80px;
            height: 80px;
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 48px;
            cursor: pointer;
            transition: all 300ms ease;
        }

        .animal:hover {
            transform: scale(1.1);
        }

        /* Burbujas */
        .burbuja {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 200ms ease;
            animation: flotar 3s ease-in-out infinite;
        }

        .burbuja:hover {
            transform: scale(1.2);
        }

        @keyframes flotar {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
        }

        /* Elementos de clasificaci√≥n */
        .elemento-clasif {
            width: 80px;
            height: 80px;
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 36px;
            cursor: pointer;
            transition: all 300ms ease;
            border: 3px dashed transparent;
        }

        .elemento-clasif:hover {
            transform: scale(1.1);
            border-color: var(--texto-secundario);
        }

        /* Notificaciones */
        .notificacion {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--exito);
            color: white;
            padding: 24px 32px;
            border-radius: 32px;
            font-size: 24px;
            font-weight: 600;
            z-index: 1001;
            animation: aparecer 300ms ease-out forwards;
        }

        @keyframes aparecer {
            0% {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.8);
            }
            100% {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1);
            }
        }

        /* Controles de audio */
        .audio-activado { color: var(--exito); }
        .audio-desactivado { color: var(--texto-secundario); }

        /* Responsive */
        @media (max-width: 600px) {
            .titulo { font-size: 36px; }
            .subtitulo { font-size: 28px; }
            .instrucciones { font-size: 20px; }
            .btn-principal { 
                min-width: 100%; 
                margin: 0 24px;
            }
            .lista-opciones {
                flex-direction: column;
            }
            .barra-progreso {
                width: 300px;
            }
        }
    </style>
</head>
<body>
    <!-- Cursor personalizado -->
    <div class="cursor-personalizado" id="cursorPersonalizado">ü¶ã</div>

    <!-- Navegaci√≥n fija -->
    <div class="nav-fija">
        <button class="btn-nav" id="btnCasa" onclick="mostrarPantalla('bienvenida')" title="Volver al inicio üåü">üåü</button>
        <button class="btn-nav" id="btnAudio" onclick="toggleAudio()">üîä</button>
    </div>

    <!-- Pantalla de Bienvenida -->
    <div class="pantalla activa" id="bienvenida">
        <div class="contenedor">
            <h1 class="titulo">üåà Mundo Curioso üåà</h1>
            <p class="instrucciones">
                ¬°Bienvenido al Mundo Curioso! Soy tu compa√±ero en aventuras incre√≠bles.<br>
                Primero, selecciona tu edad para adaptar la experiencia:
            </p>
            
            <div class="lista-opciones">
                <div class="tarjeta-seleccion" onclick="seleccionarEdad(3)">
                    <div class="avatar edad-3-4">üêª</div>
                    <h3>3-4 a√±os</h3>
                    <p>Modo principiante</p>
                </div>
                
                <div class="tarjeta-seleccion" onclick="seleccionarEdad(5)">
                    <div class="avatar edad-5-6">ü¶Ñ</div>
                    <h3>5-6 a√±os</h3>
                    <p>Modo explorador</p>
                </div>
                
                <div class="tarjeta-seleccion" onclick="seleccionarEdad(7)">
                    <div class="avatar edad-7-8">üê®</div>
                    <h3>7-8 a√±os</h3>
                    <p>Modo aventurero</p>
                </div>
                
                <div class="tarjeta-seleccion" onclick="seleccionarEdad(9)">
                    <div class="avatar edad-9-10">ü¶ã</div>
                    <h3>9-10 a√±os</h3>
                    <p>Modo experto</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Pantalla de Selecci√≥n de Juegos -->
    <div class="pantalla" id="juegos">
        <div class="contenedor">
            <h2 class="subtitulo">üéÆ ¬°Elige tu aventura especial!</h2>
            <p class="instrucciones">Cada aventura te ayudar√° a aprender de forma divertida:</p>
            
            <div class="lista-opciones">
                <button class="btn-principal" onclick="iniciarJardin()">
                    üè† <span>Animales Extravagantes</span>
                </button>
                
                <button class="btn-principal" onclick="iniciarBurbujas()">
                    üè† <span>Burbujas</span>
                </button>
                
                <button class="btn-principal" onclick="iniciarClasificacion()">
                    üè† <span>Clasificar Colores</span>
                </button>
                
                <button class="btn-principal" onclick="iniciarMelodia()">
                    üè† <span>Sigue la Melod√≠a</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Pantalla del Jard√≠n M√°gico -->
    <div class="pantalla" id="jardin">
        <div class="contenedor">
            <h2 class="subtitulo">üå∫ Animales Extravagantes üå∫</h2>
            <p class="instrucciones">¬°Conoce estos animales incre√≠bles! T√≥calos para alimentarlos.</p>
            
            <div class="barra-progreso">
                <div class="progreso-fill" id="progresoJardin"></div>
            </div>
            
            <div class="lista-opciones" id="animalesJardin">
                <!-- Los animales se generar√°n din√°micamente -->
            </div>
        </div>
    </div>

    <!-- Pantalla de Burbujas -->
    <div class="pantalla" id="burbujas">
        <div class="contenedor">
            <h2 class="subtitulo">üíé Burbujas M√°gicas üíé</h2>
            <p class="instrucciones">¬°Pincha las burbujas que aparecen!</p>
            
            <div class="barra-progreso">
                <div class="progreso-fill" id="progresoBurbujas"></div>
            </div>
            
            <div id="areaBurbujas" style="position: relative; width: 400px; height: 300px; margin: 0 auto;">
                <!-- Las burbujas se generar√°n din√°micamente -->
            </div>
        </div>
    </div>

    <!-- Pantalla de Clasificaci√≥n -->
    <div class="pantalla" id="clasificacion">
        <div class="contenedor">
            <h2 class="subtitulo">üé® Clasificar por Color üé®</h2>
            <p class="instrucciones">Arrastra los elementos a sus colores correspondientes.</p>
            
            <div class="barra-progreso">
                <div class="progreso-fill" id="progresoClasificacion"></div>
            </div>
            
            <div style="display: flex; gap: 48px; justify-content: center; margin: 32px 0;">
                <div id="areaClasificacion" style="display: grid; grid-template-columns: repeat(2, 150px); gap: 24px;">
                    <!-- Las zonas de clasificaci√≥n se generar√°n din√°micamente -->
                </div>
            </div>
            
            <div id="elementosClasificar" style="display: flex; gap: 16px; justify-content: center; flex-wrap: wrap;">
                <!-- Los elementos a clasificar se generar√°n din√°micamente -->
            </div>
        </div>
    </div>

    <!-- Pantalla de Melod√≠a -->
    <div class="pantalla" id="melodia">
        <div class="contenedor">
            <h2 class="subtitulo">üéµ Sigue la Melod√≠a üéµ</h2>
            <p class="instrucciones">Escucha la secuencia y rep√≠tela tocando las notas.</p>
            
            <div class="barra-progreso">
                <div class="progreso-fill" id="progresoMelodia"></div>
            </div>
            
            <div class="lista-opciones" id="notasMusicales">
                <!-- Las notas musicales se generar√°n din√°micamente -->
            </div>
        </div>
    </div>

    <script>
        // Variables globales
        let edadUsuario = null;
        let audioActivado = true;
        let puntuacion = 0;
        let nivelActual = 1;
        
        // Datos de animales poco comunes
        const animalesPocosConocidos = [
            { emoji: 'ü¶¶', nombre: 'Nutria Marina', sonidos: '¬°Hola! Soy Nutria Marina ü¶¶' },
            { emoji: 'ü¶î', nombre: 'Erizo', sonidos: '¬°Hola! Soy Erizo ü¶î' },
            { emoji: 'ü¶ú', nombre: 'Loro Gris', sonidos: '¬°Hola! Soy Loro Gris ü¶ú' },
            { emoji: 'ü¶≠', nombre: 'Foca', sonidos: '¬°Hola! Soy Foca ü¶≠' },
            { emoji: 'ü¶ò', nombre: 'Canguro', sonidos: '¬°Hola! Soy Canguro ü¶ò' },
            { emoji: 'ü¶í', nombre: 'Jirafa', sonidos: '¬°Hola! Soy Jirafa ü¶í' },
            { emoji: 'ü¶ú', nombre: 'Papagayo', sonidos: '¬°Hola! Soy Papagayo ü¶ú' },
            { emoji: 'ü¶ß', nombre: 'Orangut√°n', sonidos: '¬°Hola! Soy Orangut√°n ü¶ß' }
        ];

        // Inicializaci√≥n
        document.addEventListener('DOMContentLoaded', function() {
            inicializarCursor();
            cambiarCursor('bienvenida');
            hablar('¬°Bienvenido al Mundo Curioso! Selecciona tu edad para comenzar.');
        });

        // Cursor personalizado
        function inicializarCursor() {
            const cursor = document.getElementById('cursorPersonalizado');
            
            document.addEventListener('mousemove', function(e) {
                cursor.style.left = e.clientX - 24 + 'px';
                cursor.style.top = e.clientY - 24 + 'px';
            });
            
            document.addEventListener('click', function() {
                cursor.classList.add('cursor-click');
                setTimeout(() => cursor.classList.remove('cursor-click'), 200);
            });
        }

        // Sistema de audio
        let cursorActual = 'ü¶ã'; // Estado inicial del cursor
        
        function cambiarCursor(tema) {
            const cursor = document.getElementById('cursorPersonalizado');
            
            const temas = {
                'jardin': { emoji: 'ü¶ã', color: 'var(--aventura1-violeta)' },
                'burbujas': { emoji: 'üíé', color: 'var(--burbujas-azul-prim)' },
                'clasificacion': { emoji: 'üé®', color: 'var(--clasif-rojo)' },
                'melodia': { emoji: 'üéµ', color: 'var(--melodia-dorado)' },
                'bienvenida': { emoji: 'üåà', color: 'var(--aventura1-turquesa)' }
            };
            
            const nuevoTema = temas[tema] || temas['bienvenida'];
            cursor.textContent = nuevoTema.emoji;
            cursor.style.backgroundColor = nuevoTema.color;
            cursorActual = nuevoTema.emoji;
        }
            if (!audioActivado) return;
            
            if ('speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(texto);
                utterance.lang = 'es-ES';
                utterance.rate = edadUsuario ? (edadUsuario <= 4 ? 0.7 : 0.9) : 0.8;
                utterance.pitch = 1.2;
                utterance.volume = 0.8;
                speechSynthesis.speak(utterance);
            }
        }

        function toggleAudio() {
            audioActivado = !audioActivado;
            const btn = document.getElementById('btnAudio');
            btn.textContent = audioActivado ? 'üîä' : 'üîá';
            
            if (audioActivado) {
                hablar('Audio activado - Mundo Curioso');
            }
        }

        function reproducirSonido(frecuencia, duracion = 500) {
            if (!audioActivado) return;
            
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.setValueAtTime(frecuencia, audioContext.currentTime);
                oscillator.type = 'sine';
                
                gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + duracion / 1000);
                
                oscillator.start();
                oscillator.stop(audioContext.currentTime + duracion / 1000);
            } catch (error) {
                console.log('Audio no disponible');
            }
        }

        // Navegaci√≥n
        function mostrarPantalla(pantallaId) {
            // Ocultar todas las pantallas
            document.querySelectorAll('.pantalla').forEach(p => p.classList.remove('activa'));
            
            // Mostrar la pantalla seleccionada
            document.getElementById(pantallaId).classList.add('activa');
            
            // Cambiar cursor seg√∫n la pantalla
            const temaPantalla = {
                'bienvenida': 'bienvenida',
                'juegos': 'bienvenida',
                'jardin': 'jardin',
                'burbujas': 'burbujas',
                'clasificacion': 'clasificacion',
                'melodia': 'melodia'
            };
            cambiarCursor(temaPantalla[pantallaId]);
            
            // Feedback especial seg√∫n la pantalla
            if (pantallaId === 'bienvenida') {
                // Sonido especial m√°gico cuando se usa el bot√≥n estrella
                reproducirSonido(523); // Do
                setTimeout(() => reproducirSonido(659), 150); // Mi
                setTimeout(() => reproducirSonido(784), 300); // Sol
                setTimeout(() => hablar('¬°Volviendo al inicio! ¬øNueva aventura?'), 450);
            } else {
                // Sonido normal para otras navegaciones
                reproducirSonido(800);
            }
        }

        function seleccionarEdad(edad) {
            edadUsuario = edad;
            
            // Quitar selecci√≥n de todas las tarjetas
            document.querySelectorAll('.tarjeta-seleccion').forEach(t => t.classList.remove('seleccionada'));
            
            // Seleccionar la tarjeta correspondiente
            const tarjetas = document.querySelectorAll('.tarjeta-seleccion');
            tarjetas[edad - 3].classList.add('seleccionada');
            
            // Mensaje personalizado por edad
            const mensajes = {
                3: '¬°Perfecto! Est√°s en modo principiante. Todo ser√° muy sencillo.',
                5: '¬°Excelente! Est√°s en modo explorador. Aprender√°s cosas nuevas.',
                7: '¬°Genial! Est√°s en modo aventurero. Ser√° un gran desaf√≠o.',
                9: '¬°Incre√≠ble! Est√°s en modo experto. ¬°Demuestra tu habilidad!'
            };
            
            hablar(mensajes[edad]);
            
            // Despu√©s de 2 segundos, ir a selecci√≥n de juegos
            setTimeout(() => {
                mostrarPantalla('juegos');
                hablar('Ahora elige tu aventura favorita. ¬°Divi√©rtete!');
            }, 2000);
        }

        // Juego del Jard√≠n M√°gico
        function iniciarJardin() {
            mostrarPantalla('jardin');
            const animalesContainer = document.getElementById('animalesJardin');
            animalesContainer.innerHTML = '';
            
            // Mostrar animales aleatorios
            const animalesMezclados = [...animalesPocosConocidos].sort(() => 0.5 - Math.random());
            const cantidadAnimales = edadUsuario <= 4 ? 3 : edadUsuario <= 6 ? 4 : 6;
            
            for (let i = 0; i < cantidadAnimales; i++) {
                const animal = animalesMezclados[i];
                const animalDiv = document.createElement('div');
                animalDiv.className = 'animal';
                animalDiv.textContent = animal.emoji;
                animalDiv.onclick = () => alimentarAnimal(animal);
                animalesContainer.appendChild(animalDiv);
            }
            
            hablar('¬°Bienvenido al mundo de Animales Extravagantes! Toca cada animal para alimentarlo y cuidarlo.');
        }

        function alimentarAnimal(animal) {
            puntuacion += 10;
            actualizarProgreso('progresoJardin', puntuacion / 20);
            
            // Efecto visual
            mostrarCelebracion('‚≠ê');
            hablar(`¬°Excelente! Has alimentado al ${animal.nombre}. ${animal.sonidos}`);
            
            // Remover el animal despu√©s de alimentar
            event.target.style.opacity = '0';
            event.target.style.transform = 'scale(0)';
            
            // Completar cuando todos est√©n alimentados
            if (puntuacion >= 20) {
                setTimeout(() => {
                    mostrarNotificacion('¬°Felicitaciones! Has cuidado todos los animales üå∫');
                    hablar('¬°Felicitaciones! Has cuidado a todos los animales. ¬°Eres incre√≠ble!');
                    setTimeout(() => {
                        mostrarPantalla('juegos');
                        puntuacion = 0;
                    }, 3000);
                }, 500);
            }
        }

        // Juego de Burbujas
        function iniciarBurbujas() {
            mostrarPantalla('burbujas');
            puntuacion = 0;
            
            const coloresBurbujas = [
                '#60A5FA', '#F472B6', '#FB923C', '#3B82F6',
                '#10B981', '#FACC15', '#EF4444', '#8B5CF6'
            ];
            
            const area = document.getElementById('areaBurbujas');
            area.innerHTML = '';
            
            // Crear burbujas
            for (let i = 0; i < 8; i++) {
                const burbuja = document.createElement('div');
                burbuja.className = 'burbuja';
                burbuja.style.backgroundColor = coloresBurbujas[i % coloresBurbujas.length];
                burbuja.style.position = 'absolute';
                burbuja.style.left = (Math.random() * 320) + 'px';
                burbuja.style.top = (Math.random() * 220) + 'px';
                burbuja.onclick = () => pincharBurbuja(burbuja);
                area.appendChild(burbuja);
            }
            
            hablar('¬°Pincha las burbujas que aparecen! ¬°Cada burbuja te dar√° puntos!');
        }

        function pincharBurbuja(burbuja) {
            puntuacion += 5;
            actualizarProgreso('progresoBurbujas', puntuacion / 40);
            
            // Efecto de explosi√≥n
            burbuja.style.transform = 'scale(1.5)';
            burbuja.style.opacity = '0';
            burbuja.style.transition = 'all 300ms ease';
            
            mostrarCelebracion('üí•');
            reproducirSonido(1000);
            hablar('¬°Excelente! Has pinchado una burbuja.');
            
            // Remover despu√©s de la animaci√≥n
            setTimeout(() => {
                burbuja.remove();
            }, 300);
            
            if (puntuacion >= 40) {
                setTimeout(() => {
                    mostrarNotificacion('¬°Perfecto! Has pinchado todas las burbujas üíé');
                    hablar('¬°Incre√≠ble! Has pinchado todas las burbujas. ¬°Eres un experto!');
                    setTimeout(() => {
                        mostrarPantalla('juegos');
                        puntuacion = 0;
                    }, 3000);
                }, 500);
            }
        }

        // Juego de Clasificaci√≥n
        function iniciarClasificacion() {
            mostrarPantalla('clasificacion');
            puntuacion = 0;
            
            const colores = ['üî¥', 'üü°', 'üîµ', 'üü¢'];
            const nombresColores = ['Rojo', 'Amarillo', 'Azul', 'Verde'];
            const coloresHex = ['#EF4444', '#FACC15', '#2563EB', '#10B981'];
            
            // Crear zonas de clasificaci√≥n
            const area = document.getElementById('areaClasificacion');
            area.innerHTML = '';
            
            for (let i = 0; i < 4; i++) {
                const zona = document.createElement('div');
                zona.className = 'elemento-clasif';
                zona.style.backgroundColor = coloresHex[i];
                zona.style.opacity = '0.3';
                zona.style.borderStyle = 'solid';
                zona.textContent = colores[i];
                zona.ondragover = (e) => e.preventDefault();
                zona.ondrop = (e) => {
                    const elementoId = e.dataTransfer.getData('text');
                    clasificarElemento(elementoId, i);
                };
                area.appendChild(zona);
            }
            
            // Crear elementos a clasificar
            const elementos = document.getElementById('elementosClasificar');
            elementos.innerHTML = '';
            
            const cantidadElementos = edadUsuario <= 4 ? 4 : edadUsuario <= 6 ? 6 : 8;
            
            for (let i = 0; i < cantidadElementos; i++) {
                const colorCorrecto = Math.floor(Math.random() * 4);
                const elemento = document.createElement('div');
                elemento.className = 'elemento-clasif';
                elemento.draggable = true;
                elemento.textContent = colores[colorCorrecto];
                elemento.style.backgroundColor = coloresHex[colorCorrecto];
                elemento.id = `elemento-${i}`;
                elemento.ondragstart = (e) => {
                    e.dataTransfer.setData('text', elemento.id);
                    e.dataTransfer.setData('color', colorCorrecto);
                };
                elementos.appendChild(elemento);
            }
            
            hablar('Arrastra cada elemento a su color correspondiente. ¬°S√© cuidadoso!');
        }

        function clasificarElemento(elementoId, zonaColor) {
            const elemento = document.getElementById(elementoId);
            const colorCorrecto = parseInt(event.dataTransfer.getData('color'));
            
            if (colorCorrecto === zonaColor) {
                puntuacion += 5;
                actualizarProgreso('progresoClasificacion', puntuacion / 25);
                
                // Elemento correcto
                elemento.style.opacity = '0.5';
                elemento.style.pointerEvents = 'none';
                mostrarCelebracion('‚úÖ');
                hablar('¬°Correcto! Has clasificado bien el elemento.');
                
                if (puntuacion >= 25) {
                    setTimeout(() => {
                        mostrarNotificacion('¬°Excelente! Has clasificado todos los elementos üé®');
                        hablar('¬°Fant√°stico! Has clasificado todos los elementos correctamente.');
                        setTimeout(() => {
                            mostrarPantalla('juegos');
                            puntuacion = 0;
                        }, 3000);
                    }, 500);
                }
            } else {
                // Elemento incorrecto
                elemento.style.borderColor = '#EF4444';
                elemento.style.animation = 'shake 300ms ease-in-out';
                hablar('¬°Ups! Intenta de nuevo. Recuerda el color correcto.');
            }
        }

        // Juego de Melod√≠a
        function iniciarMelodia() {
            mostrarPantalla('melodia');
            puntuacion = 0;
            
            const notas = [
                { emoji: 'üéµ', freq: 523, color: '#F59E0B' },
                { emoji: 'üé∂', freq: 659, color: '#FB7185' },
                { emoji: 'üéº', freq: 784, color: '#D97706' },
                { emoji: 'üé§', freq: 988, color: '#F9A8D4' }
            ];
            
            // Crear botones de notas
            const container = document.getElementById('notasMusicales');
            container.innerHTML = '';
            
            notas.forEach((nota, index) => {
                const btn = document.createElement('button');
                btn.className = 'btn-principal';
                btn.style.backgroundColor = nota.color;
                btn.innerHTML = `${nota.emoji} <span>Nota ${index + 1}</span>`;
                btn.onclick = () => tocarNota(nota.freq, index);
                container.appendChild(btn);
            });
            
            // Generar secuencia
            const secuencia = generarSecuencia();
            setTimeout(() => reproducirSecuencia(secuencia, notas), 1000);
            
            hablar('Escucha la secuencia de notas y luego rep√≠tela tocando los botones.');
        }

        function generarSecuencia() {
            const longitud = edadUsuario <= 4 ? 3 : edadUsuario <= 6 ? 4 : 5;
            const secuencia = [];
            
            for (let i = 0; i < longitud; i++) {
                secuencia.push(Math.floor(Math.random() * 4));
            }
            
            return secuencia;
        }

        function reproducirSecuencia(secuencia, notas) {
            secuencia.forEach((nota, index) => {
                setTimeout(() => {
                    reproducirSonido(notas[nota].freq);
                    // Efecto visual en el bot√≥n
                    const botones = document.querySelectorAll('#notasMusicas .btn-principal');
                    botones[nota].style.transform = 'scale(0.9)';
                    setTimeout(() => {
                        botones[nota].style.transform = 'scale(1)';
                    }, 300);
                }, index * 1000);
            });
        }

        function tocarNota(frecuencia, indice) {
            reproducirSonido(frecuencia);
            // Aqu√≠ ir√≠a la l√≥gica de comparar con la secuencia
            puntuacion += 5;
            actualizarProgreso('progresoMelodia', puntuacion / 25);
            
            if (puntuacion >= 25) {
                mostrarNotificacion('¬°Perfecto! Has repetido la melod√≠a üéµ');
                hablar('¬°Incre√≠ble! Has reproducido la melod√≠a correctamente.');
                setTimeout(() => {
                    mostrarPantalla('juegos');
                    puntuacion = 0;
                }, 3000);
            }
        }

        // Funciones auxiliares
        function actualizarProgreso(elementoId, porcentaje) {
            const elemento = document.getElementById(elementoId);
            elemento.style.width = (porcentaje * 100) + '%';
        }

        function mostrarCelebracion(simbolo) {
            const celebracion = document.createElement('div');
            celebracion.className = 'celebracion';
            celebracion.textContent = simbolo;
            document.body.appendChild(celebracion);
            
            setTimeout(() => celebracion.remove(), 2000);
        }

        function mostrarNotificacion(mensaje) {
            const notificacion = document.createElement('div');
            notificacion.className = 'notificacion';
            notificacion.textContent = mensaje;
            document.body.appendChild(notificacion);
            
            setTimeout(() => notificacion.remove(), 3000);
        }

        // Animaci√≥n CSS para shake
        const style = document.createElement('style');
        style.textContent = `
            @keyframes shake {
                0%, 100% { transform: translateX(0); }
                25% { transform: translateX(-5px); }
                75% { transform: translateX(5px); }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>